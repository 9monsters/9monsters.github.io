<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.33">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>Spring Boot 实现websocket 通信 | </title><meta name="description" content="Spring Boot 实现websocket 通信">
    <link rel="modulepreload" href="/assets/app.ec2e3b1c.js"><link rel="modulepreload" href="/assets/SpringBoot 实现 Websocket 通信详解.html.ef67f3be.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/SpringBoot 实现 Websocket 通信详解.html.788cecf2.js">
    <link rel="stylesheet" href="/assets/style.fc8b2427.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><!----></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p class="sidebar-item sidebar-heading">Spring Boot 实现websocket 通信 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#websocket-简介" class="router-link-active router-link-exact-active sidebar-item" aria-label="WebSocket 简介"><!--[--><!--]--> WebSocket 简介 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#websocket-特点" class="router-link-active router-link-exact-active sidebar-item" aria-label="WebSocket 特点"><!--[--><!--]--> WebSocket 特点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#为什么需要-websocket" class="router-link-active router-link-exact-active sidebar-item" aria-label="为什么需要 WebSocket"><!--[--><!--]--> 为什么需要 WebSocket <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#websocket-连接流程" class="router-link-active router-link-exact-active sidebar-item" aria-label="WebSocket 连接流程"><!--[--><!--]--> WebSocket 连接流程 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#websocket-使用场景" class="router-link-active router-link-exact-active sidebar-item" aria-label="WebSocket 使用场景"><!--[--><!--]--> WebSocket 使用场景 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#websocket-中子协议支持" class="router-link-active router-link-exact-active sidebar-item" aria-label="WebSocket 中子协议支持"><!--[--><!--]--> WebSocket 中子协议支持 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#什么是-stomp-协议" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是 STOMP 协议"><!--[--><!--]--> 什么是 STOMP 协议 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#spring-封装的-stomp" class="router-link-active router-link-exact-active sidebar-item" aria-label="Spring 封装的 STOMP"><!--[--><!--]--> Spring 封装的 STOMP <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#springboot-实现-websocket-示例一-实现简单的广播模式" class="router-link-active router-link-exact-active sidebar-item" aria-label="SpringBoot 实现 WebSocket 示例一：实现简单的广播模式"><!--[--><!--]--> SpringBoot 实现 WebSocket 示例一：实现简单的广播模式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#springboot-实现-websocket-示例二-实现点对点模式-引入-spring-security-实现鉴权" class="router-link-active router-link-exact-active sidebar-item" aria-label="SpringBoot 实现 WebSocket 示例二：实现点对点模式(引入 Spring Security 实现鉴权)"><!--[--><!--]--> SpringBoot 实现 WebSocket 示例二：实现点对点模式(引入 Spring Security 实现鉴权) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#springboot-实现-websocket-示例三-实现点对点模式-根据请求头-header-实现鉴权" class="router-link-active router-link-exact-active sidebar-item" aria-label="SpringBoot 实现 WebSocket 示例三：实现点对点模式(根据请求头 Header 实现鉴权)"><!--[--><!--]--> SpringBoot 实现 WebSocket 示例三：实现点对点模式(根据请求头 Header 实现鉴权) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#springboot-实现-websocket-示例四-实现点对点模式-根据-http-session-实现鉴权" class="router-link-active router-link-exact-active sidebar-item" aria-label="SpringBoot 实现 WebSocket 示例四：实现点对点模式(根据 HTTP Session 实现鉴权)"><!--[--><!--]--> SpringBoot 实现 WebSocket 示例四：实现点对点模式(根据 HTTP Session 实现鉴权) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#springboot-结合-websocket-的常用方法示例" class="router-link-active router-link-exact-active sidebar-item" aria-label="SpringBoot 结合 WebSocket 的常用方法示例"><!--[--><!--]--> SpringBoot 结合 WebSocket 的常用方法示例 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#websocket-开启跨域选项" class="router-link-active router-link-exact-active sidebar-item" aria-label="WebSocket 开启跨域选项"><!--[--><!--]--> WebSocket 开启跨域选项 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2022/01/SpringBoot%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E9%80%9A%E4%BF%A1%E8%AF%A6%E8%A7%A3.html#websocket-用户上、下线监听" class="router-link-active router-link-exact-active sidebar-item" aria-label="WebSocket 用户上、下线监听"><!--[--><!--]--> WebSocket 用户上、下线监听 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h2 id="websocket-简介" tabindex="-1"><a class="header-anchor" href="#websocket-简介" aria-hidden="true">#</a> WebSocket 简介</h2><p>WebSocket 是一种基于 TCP 的网络协议。在 2009 年诞生，于 2011 年被 IETF 定为标准 RFC 6455 通信标准，并由 RFC7936 补充规范。WebSocket API 也被 W3C 定为标准。</p><p>WebSocket 也是一种全双工通信的协议，既允许客户端向服务器主动发送消息，也允许服务器主动向客户端发送消息。在 WebSocket 中，浏览器和服务器只需要完成一次握手，两者之间就可以建立持久性的连接，进行双向数据传输。</p><h2 id="websocket-特点" tabindex="-1"><a class="header-anchor" href="#websocket-特点" aria-hidden="true">#</a> WebSocket 特点</h2><ul><li>连接握手阶段使用 HTTP 协议；</li><li>协议标识符是 ws，如果采用加密则是 wss；</li><li>数据格式比较轻量，性能开销小，通信高效；</li><li>没有同源限制，客户端可以与任意服务器通信；</li><li>建立在 TCP 协议之上，服务器端的实现比较容易；</li><li>通过 WebSocket 可以发送文本，也可以发送二进制数据；</li><li>与 HTTP 协议有着良好的兼容性。默认端口也是 80 和 443，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器；</li></ul><h2 id="为什么需要-websocket" tabindex="-1"><a class="header-anchor" href="#为什么需要-websocket" aria-hidden="true">#</a> 为什么需要 WebSocket</h2><ol><li><p>短轮询(Traditional Polling)</p><p>短轮询是指客户端每隔一段时间就询问一次服务器是否有新的消息，如果有就接收消息。这样方式会增加很多次无意义的发送请求信息，每次都会耗费流量及处理器资源。</p><ul><li>优点：短连接，服务器处理简单，支持跨域、浏览器兼容性较好。</li><li>缺点：有一定延迟、服务器压力较大，浪费带宽流量、大部分是无效请求。</li></ul></li><li><p>长轮询(Long Polling)</p><p>长轮询是段轮询的改进，客户端执行 HTTP 请求发送消息到服务器后，等待服务器回应，如果没有新的消息就一直等待，知道服务器有新消息传回或者超时。这也是个反复的过程，这种做法只是减小了网络带宽和处理器的消耗，但是带来的问题是导致消息实时性低，延迟严重。而且也是基于循环，最根本的带宽及处理器资源占用并没有得到有效的解决。</p><ul><li>优点：减少轮询次数，低延迟，浏览器兼容性较好。</li><li>缺点：服务器需要保持大量连接。</li></ul></li></ol><h2 id="websocket-连接流程" tabindex="-1"><a class="header-anchor" href="#websocket-连接流程" aria-hidden="true">#</a> WebSocket 连接流程</h2><h2 id="websocket-使用场景" tabindex="-1"><a class="header-anchor" href="#websocket-使用场景" aria-hidden="true">#</a> WebSocket 使用场景</h2><h2 id="websocket-中子协议支持" tabindex="-1"><a class="header-anchor" href="#websocket-中子协议支持" aria-hidden="true">#</a> WebSocket 中子协议支持</h2><h2 id="什么是-stomp-协议" tabindex="-1"><a class="header-anchor" href="#什么是-stomp-协议" aria-hidden="true">#</a> 什么是 STOMP 协议</h2><h2 id="spring-封装的-stomp" tabindex="-1"><a class="header-anchor" href="#spring-封装的-stomp" aria-hidden="true">#</a> Spring 封装的 STOMP</h2><h2 id="springboot-实现-websocket-示例一-实现简单的广播模式" tabindex="-1"><a class="header-anchor" href="#springboot-实现-websocket-示例一-实现简单的广播模式" aria-hidden="true">#</a> SpringBoot 实现 WebSocket 示例一：实现简单的广播模式</h2><h2 id="springboot-实现-websocket-示例二-实现点对点模式-引入-spring-security-实现鉴权" tabindex="-1"><a class="header-anchor" href="#springboot-实现-websocket-示例二-实现点对点模式-引入-spring-security-实现鉴权" aria-hidden="true">#</a> SpringBoot 实现 WebSocket 示例二：实现点对点模式(引入 Spring Security 实现鉴权)</h2><h2 id="springboot-实现-websocket-示例三-实现点对点模式-根据请求头-header-实现鉴权" tabindex="-1"><a class="header-anchor" href="#springboot-实现-websocket-示例三-实现点对点模式-根据请求头-header-实现鉴权" aria-hidden="true">#</a> SpringBoot 实现 WebSocket 示例三：实现点对点模式(根据请求头 Header 实现鉴权)</h2><h2 id="springboot-实现-websocket-示例四-实现点对点模式-根据-http-session-实现鉴权" tabindex="-1"><a class="header-anchor" href="#springboot-实现-websocket-示例四-实现点对点模式-根据-http-session-实现鉴权" aria-hidden="true">#</a> SpringBoot 实现 WebSocket 示例四：实现点对点模式(根据 HTTP Session 实现鉴权)</h2><h2 id="springboot-结合-websocket-的常用方法示例" tabindex="-1"><a class="header-anchor" href="#springboot-结合-websocket-的常用方法示例" aria-hidden="true">#</a> SpringBoot 结合 WebSocket 的常用方法示例</h2><h3 id="websocket-开启跨域选项" tabindex="-1"><a class="header-anchor" href="#websocket-开启跨域选项" aria-hidden="true">#</a> WebSocket 开启跨域选项</h3><h3 id="websocket-用户上、下线监听" tabindex="-1"><a class="header-anchor" href="#websocket-用户上、下线监听" aria-hidden="true">#</a> WebSocket 用户上、下线监听</h3><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: wangjia@patsnap.com">wangjia</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.ec2e3b1c.js" defer></script>
  </body>
</html>
